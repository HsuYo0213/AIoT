<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>功課1 - 線性回歸範例</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body class="bg-light">

<div class="container mt-5">
    <h1 class="text-center mb-4">功課1 - 線性回歸範例</h1>

    <div class="row">
        <div class="col-md-4">
            <h5>Input Parameters</h5>
            <div class="mb-3">
                <label for="slopeRange" class="form-label">Select slope (a)</label>
                <input type="range" class="form-range" id="slopeRange" min="-100" max="100" step="0.1" value="1">
                <span id="slopeValue">1</span>
            </div>

            <div class="mb-3">
                <label for="noiseRange" class="form-label">Select noise scale (c)</label>
                <input type="range" class="form-range" id="noiseRange" min="0" max="100" step="1" value="10">
                <span id="noiseValue">10</span>
            </div>

            <div class="mb-3">
                <label for="pointsRange" class="form-label">Select number of points (n)</label>
                <input type="range" class="form-range" id="pointsRange" min="10" max="500" value="100">
                <span id="pointsValue">100</span>
            </div>

            <button class="btn btn-primary" onclick="generatePlot()">Generate Plot</button>
        </div>

        <div class="col-md-8">
            <div id="plot" class="border rounded" style="height: 400px;"></div>
        </div>
    </div>

    <div class="text-center mt-4">
        <button class="btn btn-secondary" onclick="window.history.back()">返回上一頁</button>
    </div>
</div>

<script>
    function generatePlot() {
        const slope = parseFloat(document.getElementById('slopeRange').value);
        const noise = parseFloat(document.getElementById('noiseRange').value);
        const points = parseInt(document.getElementById('pointsRange').value);

        document.getElementById('slopeValue').textContent = slope;
        document.getElementById('noiseValue').textContent = noise;
        document.getElementById('pointsValue').textContent = points;

        // Generate data
        const X = Array.from({length: points}, () => Math.random() * 20 - 10);
        const y = X.map(x => slope * x + 50 + noise * (Math.random() - 0.5));

        // Simple linear regression calculation
        let n = X.length;
        let sumX = X.reduce((a, b) => a + b, 0);
        let sumY = y.reduce((a, b) => a + b, 0);
        let sumXY = X.map((xi, i) => xi * y[i]).reduce((a, b) => a + b, 0);
        let sumX2 = X.map(xi => xi * xi).reduce((a, b) => a + b, 0);

        let slopeCalc = (n * sumXY - sumX * sumY) / (n * sumX2 - sumX ** 2);
        let intercept = (sumY - slopeCalc * sumX) / n;

        const xLine = [-10, 10];
        const yLine = xLine.map(x => intercept + slopeCalc * x);

        // Plotting with Plotly
        const trace1 = {
            x: X,
            y: y,
            mode: 'markers',
            type: 'scatter',
            name: 'Data Points',
            marker: { color: 'blue' }
        };

        const trace2 = {
            x: xLine,
            y: yLine,
            mode: 'lines',
            name: 'Regression Line',
            line: { color: 'red' }
        };

        const layout = {
            title: 'Linear Regression Example',
            xaxis: { title: 'X' },
            yaxis: { title: 'Y' },
            margin: { t: 50 }
        };

        Plotly.newPlot('plot', [trace1, trace2], layout);
    }

    // Generate initial plot on page load
    generatePlot();
</script>

</body>
</html>
